Change log
===============

.. contents:: Versions
   :local:
   :depth: 1

KissLog.Frontend 6.0.1
--------------------------

Release date: 15-03-2024

https://github.com/KissLog-net/KissLog-server/releases/tag/KissLog.Frontend-v6.0.1


Improvements
~~~~~~~~~~~~~~~~~~~~~~~

- | Added support for MongoDb database.
  | With this change, KissLog.Frontend does not require Sql/MySql server anymore.

- KissLog.Frontend application has been completely redesigned.

.. figure:: https://github.com/KissLog-net/KissLog-server/assets/39127098/8944691a-3f6e-4946-9a73-85390a867b87
    :alt: User interface

Configuration changes
~~~~~~~~~~~~~~~~~~~~~~~

Many configuration properties have been removed.
If you are updating an existing version of KissLog.Frontend application, it would be recommended to use the new configuration file and update it with your settings, rather than manually applying the changes.

Below are the braking changes in the KissLog.json file:

.. list-table::
   :header-rows: 1

   * - Added $.["KissLogFrontend.BasicAuth.Password"]
   * - | https://github.com/KissLog-net/KissLog-server/blob/bcc1eb0be8afea1f6389664a6c7e59e8ac13b872/KissLog.Frontend/KissLog.json#L6


.. list-table::
   :header-rows: 1

   * - Renamed $.ApplicationName to "KissLogFrontendDomain"
   * - | https://github.com/KissLog-net/KissLog-server/blob/bcc1eb0be8afea1f6389664a6c7e59e8ac13b872/KissLog.Frontend/KissLog.json#L2


.. list-table::
   :header-rows: 1

   * - Moved $.Database.ConnectionString to $.Database.[Provider].ConnectionString
   * - | https://github.com/KissLog-net/KissLog-server/blob/bcc1eb0be8afea1f6389664a6c7e59e8ac13b872/KissLog.Frontend/KissLog.json#L12


.. list-table::
   :header-rows: 1

   * - Removed $.Smtp.From
   * - | https://github.com/KissLog-net/KissLog-server/blob/bcc1eb0be8afea1f6389664a6c7e59e8ac13b872/KissLog.Frontend/KissLog.json#L22


.. list-table::
   :header-rows: 1

   * - Moved $.UserInterface.Applications.LoadHowMany to $.UserInterface.NumberOfApplicationsToPreloadOnTheDashboardPage
   * - | https://github.com/KissLog-net/KissLog-server/blob/bcc1eb0be8afea1f6389664a6c7e59e8ac13b872/KissLog.Frontend/KissLog.json#L30


Database breaking changes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

KissLog.Frontend is now using a new database schema, incompatible with the previous versions.

If you are updating an existing version of the KissLog.Frontend application, please follow these steps:

1. Update your connection string to a new database name.

2. Run the application for the first time, which will create the empty database (with the new schema).

3. Copy the existing data from the old database to the new database, using the following script (MySql language):

.. code-block:: sql

    INSERT INTO `<NEW_DATABASE>`.`application`
    (`Id`,`Organization_Id`,`Name`,`CreatedAt`)
    SELECT `Id`, `Organization_Id`, `Name`, `DateTimeCreated`
    FROM `<OLD_DATABASE>`.`application`
    WHERE `Id` NOT IN (SELECT `Id` from `NEW_DATABASE`.`application`)


    INSERT INTO `<NEW_DATABASE>`.`organization`
    (`Id`,`Name`,`CreatedAt`)
    SELECT `Id`, `Name`, `DateTimeCreated`
    FROM `<OLD_DATABASE>`.`organization`
    WHERE `Id` NOT IN (SELECT `Id` from `<NEW_DATABASE>`.`organization`)


    INSERT INTO `<NEW_DATABASE>`.`organizationalert`
    (`Id`,
    `Organization_Id`,
    `Name`,
    `Description`,
    `JavascriptCode`,
    `ThrottleInSeconds`,
    `CreatedAt`,
    `IsEnabled`,
    `AppliesToAllApplications`,
    `EmailNotificationJson`,
    `SlackNotificationJson`,
    `MicrosoftTeamsNotificationJson`)
    SELECT
    `Id`,
    `Organization_Id`,
    `Name`,
    `Description`,
    `JavascriptCode`,
    `ThrottleInSeconds`,
    `DateTimeCreated`,
    `IsActive`,
    1,
    REPLACE(REPLACE(`EmailNotification`, '"IsActive"', '"IsEnabled"'), '"Emails"', '"SendTo"'),
    REPLACE(`SlackNotification`, '"IsActive"', '"IsEnabled"'),
    REPLACE(`MicrosoftTeamsNotification`, '"IsActive"', '"IsEnabled"')
    FROM `<OLD_DATABASE>`.`alert`
    WHERE `Id` NOT IN (SELECT `Id` from `<NEW_DATABASE>`.`organizationalert`)


KissLog.Frontend 5.0.0
--------------------------

Release date: 11-05-2023

https://github.com/KissLog-net/KissLog-server/releases/tag/KissLog.Frontend-v5.0.0

This release contains improvements related to alerts functionality.

Alerts have been moved under Organization configuration.
With this change, the same alert can be used to evaluate requests generated by multiple applications.

.. note::
   If you are updating an existing instance of KissLog.Frontend, all the created alerts configurations will be lost and will need to be created again.

   Additionally, the database changes must be applied manually.

   KissLog.Frontend 5.0.0 is only compatible with KissLog.Backend 5.0.0, and, for this reason, both applications must be updated at the same time.

.. figure:: images/change-log/create-alert.png
    :alt: Creating an alert


Database changes
~~~~~~~~~~~~~~~~~~~~~~~

.. code-block:: sql

    CREATE TABLE [Alert] (
        [Id] nvarchar(450) NOT NULL,
        [Organization_Id] nvarchar(450) NOT NULL,
        [Name] nvarchar(256) NOT NULL,
        [Description] nvarchar(1000) NULL,
        [Severity] nvarchar(100) NOT NULL,
        [JavascriptCode] nvarchar(max) NOT NULL,
        [ThrottleInSeconds] int NOT NULL,
        [DateTimeCreated] datetime2 NOT NULL,
        [DateTimeUpdated] datetime2 NOT NULL,
        [IsActive] bit NOT NULL,
        [AppliesTo] nvarchar(2000) NULL,
        [SlackNotification] nvarchar(2000) NULL,
        [MicrosoftTeamsNotification] nvarchar(2000) NULL,
        [EmailNotification] nvarchar(2000) NULL,
        [WebhookNotification] nvarchar(2000) NULL,
        CONSTRAINT [PK_Alert] PRIMARY KEY ([Id]),
        CONSTRAINT [FK_Alert_Organization_Organization_Id] FOREIGN KEY ([Organization_Id]) REFERENCES [Organization] ([Id]) ON DELETE CASCADE
    );

    CREATE INDEX [IX_Alert_Organization_Id] ON [Alert] ([Organization_Id]);

    DROP TABLE [OrganizationSlackConfiguration];
    DROP TABLE [ApplicationAlert];
    DROP TABLE [ApplicationAlertEmailNotification];
    DROP TABLE [ApplicationAlertSlackNotification];

    -- if [CustomProperty] table exists
    DROP TABLE [CustomProperty];

KissLog.Frontend 4.0.0
--------------------------

Release date: 23-02-2023

https://github.com/KissLog-net/KissLog-server/releases/tag/KissLog.Frontend-v4.0.0

The application has been rebuilt on .NET 6.0 framework.

Although the application does not introduce any breaking changes, KissLog.Frontend 4.0.0 is only compatible with KissLog.Backend 4.0.0, which contains :ref:`breaking changes <on-premises/kisslog-backend/change-log:KissLog.Backend 4.0.0>`.

**KissLog.json** changes:

.. list-table::
   :header-rows: 1

   * - Property
     -
   * - "AppVersion"
     - renamed to "StaticResourcesVersion"
   * - "InternalLogs.DirectoryPath"
     - removed
   * - "InternalLogs.MinimumStatusCode"
     - removed
   * - "Database.KissLogDbContext"
     - renamed to "Database.ConnectionString"
